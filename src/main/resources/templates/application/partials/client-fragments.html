<!--Client summary fragment-->
<div th:fragment="clientSummaryFragment(clientState)"
     th:with="baseLinkUrl=${clientState == 'edit'} ? '/application/summary/client' : '/application/client'"
     class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="govuk-summary-card">
      <div class="govuk-summary-card__title-wrapper">
        <h2 class="govuk-summary-card__title">Basic details</h2>
        <ul class="govuk-summary-card__actions">
          <li th:if="${clientState == 'edit'}" class="govuk-summary-card__action">
            <a class="govuk-link" th:href="${baseLinkUrl} + '/details/deceased'">
              Report client as deceased
            </a>
          </li>
          <li class="govuk-summary-card__action">
            <a class="govuk-link" th:href="${baseLinkUrl} + '/details/basic'">
            Edit basic details
          </a>
          </li>
        </ul>
      </div>
      <div class="govuk-summary-card__content">
        <dl class="govuk-summary-list">
          <div th:replace="~{this :: summaryListDisplay('Title', ${contactTitle.description})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Surname', *{surname})}"></div>
          <div th:replace="~{this :: summaryListDisplay('First name', *{firstName})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Middle name(s)', *{middleNames})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Surname at birth', *{surnameAtBirth})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Date of birth', *{dobDay + '/' + dobMonth + '/' + dobYear})}"></div>
          <div th:replace="~{this :: summaryListDisplay('NI number', *{nationalInsuranceNumber})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Home office number', *{homeOfficeNumber})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Gender', ${gender.description})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Marital status', ${maritalStatus.description})}"></div>
          <div th:replace="~{this :: summaryListDisplayYesNo('Vulnerable client', *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayYesNo('High profile client', *{highProfileClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayYesNo('Vexatious litigant', *{vexatiousLitigant})}"></div>
          <div th:replace="~{this :: summaryListDisplayYesNo('Mental incapacity', *{mentalIncapacity})}"></div>
        </dl>
      </div>
    </div>
    <div class="govuk-summary-card">
      <div class="govuk-summary-card__title-wrapper">
        <h2 class="govuk-summary-card__title">Contact details</h2>
        <ul class="govuk-summary-card__actions">
          <li class="govuk-summary-card__action">
            <a class="govuk-link" th:href="${baseLinkUrl} + '/details/contact'">
            Edit contact details
          </a>
          </li>
        </ul>
      </div>
      <div class="govuk-summary-card__content">
        <dl class="govuk-summary-list">
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Telephone home', *{telephoneHome}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Telephone work', *{telephoneWork}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Mobile', *{telephoneMobile}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('E-mail address', *{emailAddress}, *{vulnerableClient})}"></div>

          <!--  Display password differently based off whether you are editing or creating the client  -->
          <th:block th:if="${clientState == 'create'}">
            <div th:replace="~{this :: summaryListDisplay('Password', '*******')}"></div>
          </th:block>
          <th:block th:if="${clientState == 'edit'}">
            <div th:replace="~{this :: summaryListDisplay('Password', 'Please contact the LAA to edit this')}"></div>
          </th:block>

          <div th:replace="~{this :: summaryListDisplay('Password reminder', *{passwordReminder})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Correspondence method', ${correspondenceMethod.description}, *{vulnerableClient})}"></div>

          <th:block th:if="${correspondenceLanguage}">
            <div th:replace="~{this :: summaryListDisplay('Correspondence language', ${correspondenceLanguage.description})}"></div>
          </th:block>
          <th:block th:unless="${correspondenceLanguage}">
            <div th:replace="~{this :: summaryListDisplay('Correspondence language', '')}"></div>
          </th:block>
        </dl>
      </div>
    </div>
    <div class="govuk-summary-card">
      <div class="govuk-summary-card__title-wrapper">
        <h2 class="govuk-summary-card__title">Address details</h2>
        <ul class="govuk-summary-card__actions">
          <li class="govuk-summary-card__action">
            <a class="govuk-link" th:href="${baseLinkUrl} + '/details/address'">
            Edit address details
          </a>
          </li>
        </ul>
      </div>
      <div class="govuk-summary-card__content">
        <dl class="govuk-summary-list">
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Country', ${country.description}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('House name / number', *{houseNameNumber}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Postcode', *{postcode}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Address line 1', *{addressLine1}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('Address line 2', *{addressLine2}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('City / town', *{cityTown}, *{vulnerableClient})}"></div>
          <div th:replace="~{this :: summaryListDisplayWithVulnerability('County', *{county}, *{vulnerableClient})}"></div>
        </dl>
      </div>
    </div>
    <div class="govuk-summary-card">
      <div class="govuk-summary-card__title-wrapper">
        <h2 class="govuk-summary-card__title">Equal opportunities</h2>
        <ul class="govuk-summary-card__actions">
          <li class="govuk-summary-card__action">
            <a class="govuk-link" th:href="${baseLinkUrl} + '/details/equal-opportunities-monitoring'">
            Edit equal opportunities details
          </a>
          </li>
        </ul>
      </div>
      <div class="govuk-summary-card__content">
        <dl class="govuk-summary-list">
          <div th:replace="~{this :: summaryListDisplay('Ethnic origin', ${ethnicity.description})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Disability', ${disability.description})}"></div>
          <div th:replace="~{this :: summaryListDisplay('Special considerations', ${clientDetails.specialConsiderations})}"></div>
        </dl>
      </div>
    </div>
  </div>
</div>

<!--Client basic details fragment-->
<div th:fragment="clientBasicFragment(clientState)" class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <div th:replace="~{partials/forms :: dropdown('title', 'Title', ${titles}, 'code', 'description', false)}"></div>
    <div th:replace="~{partials/forms :: textInput('surname', 'Surname', 'govuk-input--width-20')}"></div>

    <p th:if="${clientState == 'create'}" class="govuk-body">
      <span class="govuk-!-font-weight-bold govuk-!-padding-right-2">
          First name
      </span>
      <span th:text="${clientDetails.firstName}"></span>
    </p>
    <th:block th:if="${clientState == 'edit'}">
      <div th:replace="~{partials/forms :: textInput('firstName', 'First name', 'govuk-input--width-20')}"></div>
    </th:block>
    <div th:replace="~{partials/forms :: textInput('middleNames', 'Middle name(s) (optional)', 'govuk-input--width-20')}"></div>

    <p class="govuk-body">
      <span class="govuk-!-font-weight-bold govuk-!-padding-right-2">
          Surname at birth
      </span>
      <span th:text="${clientDetails.surnameAtBirth}"></span>
    </p>
    <p class="govuk-body">
      <span class="govuk-!-font-weight-bold govuk-!-padding-right-2">
          Date of birth (DD/MM/YYYY)
      </span>
      <span th:text="${clientDetails.dobDay} + '/' + ${clientDetails.dobMonth} + '/' + ${clientDetails.dobYear}"></span>
    </p>

    <div th:if="${clientState == 'create'}">
      <div th:replace="~{partials/forms :: dropdown('countryOfOrigin', 'Country of origin', ${countries}, 'code', 'description', false)}"></div>
    </div>
    <p th:if="${clientState == 'edit'}" class="govuk-body">
      <span class="govuk-!-font-weight-bold govuk-!-padding-right-2">
          Country of origin
      </span>
      <span th:text="${clientDetails.countryOfOrigin}"></span>
    </p>

    <!-- Show paragraph if nationalInsuranceNumber exists -->
    <p class="govuk-body" th:if="${clientState == 'create' && clientDetails.nationalInsuranceNumber != null && !clientDetails.nationalInsuranceNumber.isEmpty()}" >
      <span class="govuk-!-font-weight-bold govuk-!-padding-right-2">
          National Insurance Number
      </span>
      <span th:text="${clientDetails.nationalInsuranceNumber}"></span>
    </p>

    <div class="govuk-form-group" th:if="${clientState == 'edit' || clientDetails.nationalInsuranceNumber == null || clientDetails.nationalInsuranceNumber.isEmpty()}">
      <div th:replace="~{partials/forms :: textInput('nationalInsuranceNumber', 'National Insurance Number (optional)', 'govuk-input--width-20')}"></div>
      <details class="govuk-details govuk-!-margin-top-2" data-module="govuk-details">
        <summary class="govuk-details__summary">
              <span class="govuk-details__summary-text">
                National Insurance Number
              </span>
        </summary>
        <div class="govuk-details__text">
          If the client's National Insurance Number is unknown, please leave
          this field blank
        </div>
      </details>
    </div>

    <!-- Show paragraph if homeOfficeNumber exists -->
    <p class="govuk-body" th:if="${clientState == 'create' && clientDetails.homeOfficeNumber != null && !clientDetails.homeOfficeNumber.isEmpty()}">
      <span class="govuk-!-font-weight-bold govuk-!-padding-right-2">
          Home Office Number
      </span>
      <span th:text="${clientDetails.homeOfficeNumber}"></span>
    </p>

    <!-- Show input field if homeOfficeNumber does not exist -->
    <div class="govuk-form-group" th:if="${clientState == 'edit' || clientDetails.homeOfficeNumber == null || clientDetails.homeOfficeNumber.isEmpty()}">
      <div th:replace="~{partials/forms :: textInput('homeOfficeNumber', 'Home Office Number (optional)', 'govuk-input--width-20')}"></div>
      <details class="govuk-details govuk-!-margin-top-2" data-module="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            Help with Home Office Number
          </span>
        </summary>
        <div class="govuk-details__text">
          Please enter the client's Home Office reference number allocated
          by the Home Office. The number consists of a letter followed by
          a series of numbers (usually 7) and should be cited on documents
          or correspondence from the Home Office.
        </div>
      </details>
    </div>

    <!-- Show paragraph if gender exists -->
    <p class="govuk-body" th:if="${genderDisplayValue}">
      <span class="govuk-!-font-weight-bold govuk-!-padding-right-2">
          Gender
      </span>
      <span th:text="${genderDisplayValue}"></span>
    </p>

    <div th:unless="${genderDisplayValue}">
      <div th:replace="~{partials/forms :: dropdown('gender', 'Gender', ${genders}, 'code', 'description', false)}"></div>
    </div>

    <div th:replace="~{partials/forms :: dropdown('maritalStatus', 'Marital status', ${maritalStatusList}, 'code', 'description', false)}"></div>

    <div class="govuk-form-group">
      <fieldset class="govuk-fieldset">
        <legend class="govuk-fieldset__legend">
          Which types apply to your client?
        </legend>
        <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
          <div th:replace="~{this :: checkbox('vulnerableClient', 'Vulnerable client')}"></div>
          <div th:replace="~{this :: checkbox('highProfileClient', 'High profile client')}"></div>
          <div th:replace="~{this :: checkbox('vexatiousLitigant', 'Vexatious litigant')}"></div>
          <div th:replace="~{this :: checkbox('mentalIncapacity', 'Mental incapacity')}"></div>
        </div>
      </fieldset>
    </div>
    <div class="govuk-form-group">
      <details class="govuk-details" data-module="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            Help with High profile client
          </span>
        </summary>
        <div class="govuk-details__text">
          Please tick the appropriate box if you deem this matter to be high profile;
          by which we mean the proceedings have attracted media attention
          and/or are likely to attract media attention or involve person(s)
          that are noteworthy.
        </div>
      </details>
      <details class="govuk-details" data-module="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            Help with Mental incapacity
          </span>
        </summary>
        <div class="govuk-details__text">
          Please tick the appropriate box if you consider your client to have
          a mental impairment which has a substantial and long-term adverse
          effect on a persons ability to carry out normal day-to-day
          activities.
        </div>
      </details>
    </div>
  </div>
</div>

<!--Client contact details fragment-->
<th:block th:fragment="clientContactFragment(clientState)">
  <div class="govuk-grid-row" th:if="${clientDetails.vulnerableClient}">
    <div class="govuk-grid-column-two-thirds">
      <p class="govuk-body">
        You have indicated that this client is vulnerable therefore for security reasons the contact details are not applicable.
      </p>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Telephone home
          </p>
        </div>
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Not applicable
          </p>
        </div>
      </div>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Telephone work
          </p>
        </div>
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Not applicable
          </p>
        </div>
      </div>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Mobile
          </p>
        </div>
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Not applicable
          </p>
        </div>
      </div>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Email address
          </p>
        </div>
        <div class="govuk-grid-column-one-half">
          <p class="govuk-body">
            Not applicable
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="govuk-grid-row" th:unless="${clientDetails.vulnerableClient}">
    <div class="govuk-grid-column-two-thirds">
      <div th:replace="~{partials/forms :: textInput('telephoneHome', 'Telephone home (optional)', 'govuk-input--width-20')}"></div>
      <div th:replace="~{partials/forms :: textInput('telephoneWork', 'Telephone work (optional)', 'govuk-input--width-20')}"></div>
      <div th:replace="~{partials/forms :: textInput('telephoneMobile', 'Mobile (optional)', 'govuk-input--width-20')}"></div>
      <div th:replace="~{partials/forms :: textInput('emailAddress', 'E-mail address (optional)', 'govuk-input--width-20')}"></div>
    </div>
  </div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div class="govuk-form-group" th:if="${clientState == 'create'}" th:classappend="${#fields.hasErrors('password')} ? 'govuk-form-group--error' : ''">
        <label class="govuk-label" for="password">
          Password
        </label>
        <input th:errorclass="govuk-input--error"
               class="govuk-input govuk-input--width-20"
               id="password"
               name="password"
               type="password"
               data-module="govuk-input"
               th:field="*{password}">
        <br>
        <details class="govuk-details govuk-!-margin-top-2" data-module="govuk-details">
          <summary class="govuk-details__summary">
                                  <span class="govuk-details__summary-text">
                                    Help with Password
                                  </span>
          </summary>
          <div class="govuk-details__text">
            Please enter the LAA password your client has chosen. This password
            will be used to verify your client's identity if they ever need to
            contact us. If your client cannot provide their password, the
            password reminder will be used as a prompt.
          </div>
        </details>
      </div>
      <div class="govuk-form-group">
        <div th:replace="~{partials/forms :: textInput('passwordReminder', 'Password reminder', 'govuk-input--width-20')}"></div>
        <details class="govuk-details govuk-!-margin-top-2" data-module="govuk-details">
          <summary class="govuk-details__summary">
            <span class="govuk-details__summary-text">
              Help with Password reminder
            </span>
          </summary>
          <div class="govuk-details__text">
            Please enter a prompt which can be used as a password reminder.
          </div>
        </details>
      </div>
    </div>
  </div>
  <div class="govuk-grid-row" th:unless="${clientDetails.vulnerableClient}">
    <div class="govuk-grid-column-two-thirds">
      <div th:replace="~{partials/forms :: dropdown('correspondenceMethod', 'Correspondence method', ${correspondenceMethods}, 'code', 'description', false)}"></div>
    </div>
  </div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div th:replace="~{partials/forms :: dropdown('correspondenceLanguage', 'Correspondence language (optional)', ${correspondenceLanguages}, 'code', 'description', false)}"></div>
    </div>
  </div>
</th:block>

<!--Simple fragment for repeated summary list rows -->
<div class="govuk-summary-list__row" th:fragment="summaryListDisplay(label, value)">
  <dt class="govuk-summary-list__key"
      th:text="${label}">
  </dt>
  <dd class="govuk-summary-list__value"
      th:text="${value}">
  </dd>
</div>

<!--Simple fragment for repeated summary list rows with yes/no values -->
<div class="govuk-summary-list__row" th:fragment="summaryListDisplayYesNo(label, checked)">
  <dt class="govuk-summary-list__key" th:text="${label}">
  </dt>
  <dd class="govuk-summary-list__value" th:if="${checked}">
    Yes
  </dd>
  <dd class="govuk-summary-list__value" th:unless="${checked}">
    No
  </dd>
</div>
</div>

<!--Simple fragment for repeated summary list rows with an isVulnerable? check -->
<div class="govuk-summary-list__row" th:fragment="summaryListDisplayWithVulnerability(label, value, isVulnerable)">
  <dt class="govuk-summary-list__key" th:text="${label}">
  </dt>
  <dd class="govuk-summary-list__value"
      th:if="${isVulnerable}">
    Not applicable
  </dd>
  <dd class="govuk-summary-list__value"
      th:unless="${isVulnerable}"
      th:text="${value}">
  </dd>
</div>

<!--Simple fragment for repeated checkbox items -->
<div th:fragment="checkbox(id, label)" class="govuk-checkboxes__item">
  <input class="govuk-checkboxes__input"
         th:id="${id}"
         th:name="${id}"
         type="checkbox"
         th:checked="*{__${id}__}" />
  <label class="govuk-label govuk-checkboxes__label" th:for="${id}" th:text="${label}">
  </label>
  <input type="hidden" th:name="${'_' + id}" value="on">
</div>
